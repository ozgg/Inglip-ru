<section class="lexeme-wordforms">
  <h2><%= t('admin.lexemes.form.wordforms') %></h2>

  <%
    numbers = Biovision::Components::Words::VerbHandler.number_flags
    persons = Biovision::Components::Words::VerbHandler.person_flags
    forms = Biovision::Components::Words::VerbHandler.verb_form_flags
    tenses = Biovision::Components::Words::VerbHandler.tense_flags
  %>
  <% %i[tense_present tense_future].each do |tense_key| %>
    <% tense_flag = tenses[tense_key] %>
    <table>
      <caption><%= t("wordform.flags.#{tense_key}") %></caption>
      <thead>
      <tr>
        <th></th>
        <% numbers.keys.each do |key| %>
          <th data-col="<%= key %>" scope="col">
            <%= t("wordform.flags.#{key}") %>
          </th>
        <% end %>
      </tr>
      </thead>
      <tbody>
      <% persons.each do |person_key, person_flag| %>
        <tr data-row="<%= person_key %>">
          <th scope="row"><%= t("wordform.flags.#{person_key}") %></th>
          <% numbers.each do |number_key, number_flag| %>
            <% flag = person_flag | number_flag | tense_flag %>
            <td data-col="<%= number_key %>">
              <%= handler.wordform(flag) %>
            </td>
          <% end %>
        </tr>
      <% end %>
      <% if tense_key == :tense_present %>
        <tr>
          <th><%= t('wordform.flags.gerund') %></th>
          <td colspan="2">
            <% flag = tense_flag | forms[:gerund] %>
            <%= handler.wordform(flag) %>
          </td>
        </tr>
      <% end %>
      </tbody>
    </table>
  <% end %>

  <h3><%= t("wordform.flags.tense_past") %></h3>
  <dl class="fields">
    <% Biovision::Components::Words::VerbHandler.past_tense_flags.each do |key, flag| %>
      <%=
        render(
            partial: 'admin/lexemes/entity/wordform_list_flag',
            locals: { key: key, text: handler.wordform(flag) }
        )
      %>
    <% end %>
  </dl>

  <h3><%= t('wordform.flags.imperative') %></h3>
  <dl class="fields">
    <% numbers.each do |key, number_flag| %>
      <% flag = number_flag | forms[:imperative] %>
      <%=
        render(
            partial: 'admin/lexemes/entity/wordform_list_flag',
            locals: { key: key, text: handler.wordform(flag) }
        )
      %>
    <% end %>
  </dl>
</section>
